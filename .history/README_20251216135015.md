# ‚òÅÔ∏è AWS Secure Infrastructure Lab: EC2, RDS, S3 & IAM Integration

> **Laborat√≥rio Pr√°tico de Cloud Computing**
>
> *Foco: Arquitetura de Redes, Seguran√ßa, Gest√£o de Identidade e Persist√™ncia de Dados.*

Este reposit√≥rio documenta a implementa√ß√£o pr√°tica de uma infraestrutura robusta na Amazon Web Services (AWS). O projeto simula um cen√°rio real de produ√ß√£o, onde foi criada uma rede privada virtual (VPC) segmentada para hospedar uma aplica√ß√£o Node.js (EC2) que se comunica de forma segura com um banco de dados relacional (RDS) e um servi√ßo de armazenamento de objetos (S3).

---

## üìê Arquitetura da Solu√ß√£o

O diagrama abaixo ilustra a topologia da rede implementada. A arquitetura segue o princ√≠pio de **privil√©gio m√≠nimo**, garantindo que o banco de dados permane√ßa isolado da internet p√∫blica, acess√≠vel apenas pela camada de aplica√ß√£o.

![Diagrama de Arquitetura](./assets/ArquiteturaDrawio.jpg)

---

## üöÄ Etapa 1: Infraestrutura de Rede (VPC)

O alicerce do projeto foi a cria√ß√£o de uma **VPC (Virtual Private Cloud)** personalizada, fugindo das configura√ß√µes padr√£o para garantir controle total sobre o endere√ßamento de IP e rotas.

### 1.1 Planejamento de Sub-redes
Defini uma estrat√©gia de segmenta√ß√£o de rede:
* **Sub-redes P√∫blicas:** Para recursos que precisam de acesso √† internet (Application Layer).
* **Sub-redes Privadas:** Para recursos sens√≠veis como o Banco de Dados (Data Layer).

![Configura√ß√£o da VPC](./assets/vpc-configuracao-1.jpg)

### 1.2 Provisionamento
Utilizei o fluxo de trabalho da AWS para criar simultaneamente a VPC, Sub-redes, Tabelas de Rotas e Internet Gateways, garantindo a conectividade interna e externa necess√°ria.

![VPC Criada com Sucesso](./assets/vpc-criada-4.jpg)

---

## üõ°Ô∏è Etapa 2: Seguran√ßa de Rede (Security Groups)

A seguran√ßa foi implementada atrav√©s de **Security Groups** (Firewall Stateful), controlando rigorosamente o tr√°fego de entrada (Inbound) e sa√≠da (Outbound).

### 2.1 Web Security Group (EC2)
Para a inst√¢ncia da aplica√ß√£o, configurei regras espec√≠ficas:
* **HTTP (80):** Aberto para o mundo (`0.0.0.0/0`), permitindo acesso √† API.
* **SSH (22) - Hardening:** Acesso restrito estritamente ao **meu endere√ßo IP pessoal**. Isso impede ataques de for√ßa bruta e acesso n√£o autorizado ao terminal administrativo.

![Security Group Web](./assets/vpc-security-group-2.jpg)

### 2.2 Database Security Group (RDS)
Para o banco de dados, a seguran√ßa √© ainda mais restritiva:
* **PostgreSQL (5432):** A origem do tr√°fego **N√ÉO** √© um IP, mas sim o **ID do Security Group da Web** (`sg-web-projeto02`).
* *Resultado:* O banco de dados aceita conex√µes apenas se elas vierem da nossa inst√¢ncia EC2. Qualquer tentativa de conex√£o direta da internet √© bloqueada.

![Security Group Database](vpc-db-security-group-3.jpg)

---

## üîê Etapa 3: Gest√£o de Identidade e Acesso (IAM)

Para permitir que a inst√¢ncia EC2 interaja com outros servi√ßos da AWS de forma segura e audit√°vel, foi necess√°rio configurar uma Role no IAM.

> **Nota sobre o Ambiente (Escola da Nuvem):**
> Devido √†s pol√≠ticas de seguran√ßa da organiza√ß√£o educacional, a cria√ß√£o de novas Roles do zero √© restrita.

**Solu√ß√£o Aplicada:**
Identifiquei e editei uma Role existente (`voclabs`), ajustando a **Trust Policy (Pol√≠tica de Confian√ßa)**. Adicionei o servi√ßo `ec2.amazonaws.com` na a√ß√£o `sts:AssumeRole`. Isso autoriza as inst√¢ncias EC2 a "vestirem" essa credencial para realizar a√ß√µes na conta.

![Pol√≠tica de Confian√ßa IAM](IAM-politica-de-seguranca-11.jpg)

---

## üóÑÔ∏è Etapa 4: Banco de Dados Gerenciado (RDS)

Provisionamento da camada de persist√™ncia utilizando o **Amazon RDS**, garantindo alta disponibilidade e menor overhead administrativo.

### 4.1 Configura√ß√£o da Engine
Optei pelo **PostgreSQL** pela sua robustez, conformidade com SQL e suporte a dados complexos.

![Sele√ß√£o PostgreSQL](db-criacao-rds-6.jpg)

### 4.2 Credenciais e Seguran√ßa
Defini√ß√£o do usu√°rio master (`postgres`) e gera√ß√£o de uma senha forte para administra√ß√£o do cluster.

![Configura√ß√£o de Credenciais](rds-configuracao-senha-7.jpg)

### 4.3 Otimiza√ß√£o de Custos
Ajuste da classe da inst√¢ncia para `db.t4g.micro`, garantindo performance adequada para desenvolvimento dentro dos limites do **AWS Free Tier**.

![Estimativa de Custos](rds-criando-8.jpg)

### 4.4 Deploy
O banco foi implantado com sucesso na sub-rede privada, protegido pelos Security Groups configurados anteriormente.

![RDS Confirmado](rds-criando-confirmada-9.jpg)

---

## üì¶ Etapa 5: Armazenamento de Objetos (S3)

Cria√ß√£o de um **Bucket S3** (`bucketbackendprojeto02`) fora da VPC. Este recurso serve como reposit√≥rio escal√°vel para arquivos est√°ticos, logs e backups, acess√≠vel via API da AWS.

![Bucket S3 Criado](s3-bucket-criado-10.jpg)

---

## üíª Etapa 6: Configura√ß√£o do Ambiente (Linux/EC2)

Com a infraestrutura pronta, iniciei a configura√ß√£o do servidor de aplica√ß√£o.

### 6.1 Acesso Remoto Seguro
Utilizando o **Git Bash** e o par de chaves criptogr√°ficas (`.pem`), estabeleci uma conex√£o SSH segura com a inst√¢ncia Amazon Linux.

![Conex√£o SSH Git Bash](ec2-conexao-ssh-5.jpg)

### 6.2 Prepara√ß√£o do Sistema
No terminal Linux, realizei a atualiza√ß√£o dos pacotes do sistema e a instala√ß√£o das depend√™ncias necess√°rias para a aplica√ß√£o:
* Instala√ß√£o do **Node.js** (v18).
* Instala√ß√£o das bibliotecas nativas (`libbrotli`, etc).

![Instala√ß√£o Node.js e Pacotes](ssh-preparando-ambiente-12.jpg)

---

## üîå Etapa 7: Valida√ß√£o e Persist√™ncia de Dados

Para provar a integra√ß√£o total da arquitetura, desenvolvi scripts em Node.js diretamente na inst√¢ncia.

### 7.1 Teste de Conectividade
O script inicial conectou-se ao endpoint do RDS, validando:
1.  Resolu√ß√£o de DNS (VPC).
2.  Permiss√£o de Firewall (Security Group).
3.  Autentica√ß√£o (Usu√°rio/Senha).

![Conex√£o com Sucesso](rds-conexao-feita-13.jpg)

### 7.2 Manipula√ß√£o de Dados Real (CRUD)
Execu√ß√£o de um script avan√ßado que realizou opera√ß√µes de escrita e leitura no banco:
* **CREATE:** Criou a tabela `usuarios` automaticamente.
* **INSERT:** Inseriu um registro de teste ("Dev AWS 617").
* **SELECT:** Consultou e exibiu os dados no terminal.

Este passo confirma que a aplica√ß√£o tem permiss√µes funcionais de leitura e escrita no banco de dados na nuvem.

![Tabela Criada e Dados Inseridos](rds-tabela-criada-14.jpg)

---

## üèÜ Conclus√£o e Aprendizados

Este laborat√≥rio consolidou conhecimentos fundamentais de Arquitetura em Nuvem:
* **Networking:** Cria√ß√£o de VPCs e Subnets seguras.
* **Compute:** Gerenciamento de servidores Linux na nuvem.
* **Security:** Implementa√ß√£o de firewalls (SG) e gest√£o de identidades (IAM).
* **Database:** Integra√ß√£o entre aplica√ß√£o e banco de dados relacional.

---

*Projeto desenvolvido como parte da forma√ß√£o pr√°tica em AWS Cloud.*
